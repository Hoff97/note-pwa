(this.webpackJsonpnotes=this.webpackJsonpnotes||[]).push([[0],{101:function(e,t,n){},181:function(e,t,n){},185:function(e,t,n){},186:function(e,t,n){},187:function(e,t,n){},193:function(e,t,n){},194:function(e,t,n){},195:function(e,t,n){},196:function(e,t,n){},197:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(41),o=n.n(i),c=(n(76),n(13)),s=n(70),u=n(3),l=n(4),h=n(12),p=n(11),f=n(43),d=n.n(f),v=(n(96),["white","red","green","blue","orange"]);function m(e,t){var n=Object(c.a)({},e);return delete n.id,delete n.timestamp,t&&(n=t(n)),{id:e.id,timestamp:e.timestamp,data:n}}function g(e,t){var n=Object(c.a)({id:e.id,timestamp:e.timestamp,synchronized:!0},e.data);return t&&(n=t(n)),n}var k=n(7),y=n(6),b=(n(101),n(64)),E=n.n(b);n(181);function w(){var e=this.Parser,t=e.prototype.inlineTokenizers,n=e.prototype.inlineMethods;t.date=j,n.splice(n.indexOf("text"),0,"date")}function j(e,t,n){var a=/@date\(([0-9]{4}),([0-9]{2}),([0-9]{2})\)/.exec(t);if(a&&t.startsWith(a[0]))return!!n||e(a[0])({type:"date",year:parseInt(a[1]),month:parseInt(a[2])-1,day:parseInt(a[3]),children:[]})}j.notInLink=!0,j.locator=function(e,t){return e.indexOf("@",t)};n(39);var x=n(65),O=n.n(x),S=n(29);n(185);function C(e){return e<10?"0".concat(e):e}function N(e){return"@date(".concat(e.getFullYear(),",").concat(C(e.getMonth()+1),",").concat(C(e.getDate()),")")}var T=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this,t=new Date(this.props.year,this.props.month,this.props.day);return a.createElement("span",{className:"date"},a.createElement(O.a,{content:a.createElement(S.a,{value:t,onClickDay:function(t){return e.props.setDate(t,e.props.sourcePosition)}}),eventToggle:"onClick"},a.createElement("span",null,C(this.props.day),".",C(this.props.month+1),".",this.props.year)))}}]),n}(a.Component),I=(n(186),n(66));function P(e){return 0===e.children.length||1===e.children.length&&e.children[0].props.children===e.href}function D(e){return P(e)?a.createElement("div",{className:"react-tiny-link-wrap"},a.createElement(I.ReactTinyLink,{cardSize:"small",showGraphic:!0,maxLine:2,minLine:1,url:e.href,maxCacheAge:864e5,proxyUrl:"https://detext.haskai.de/cors"})):a.createElement("a",{href:e.href},e.children)}var A=n(42);n(187);function L(e){var t=e.checked,n=e.onChange,r=e.labels;return a.createElement("label",{className:"checkbox-container"},r,a.createElement("input",{type:"checkbox",checked:t,onChange:function(e){return n(e)}}),a.createElement("span",{className:"checkbox-checkmark"}))}function R(e){return e.key.startsWith("list")||e.key.startsWith("link")&&P(e.props)}function K(e){if(null!==e.checked&&void 0!==e.checked){var t=e.sourcePosition.start.line-1,n=e.children.filter((function(e){return!R(e)})),r=e.children.filter((function(e){return R(e)}));return 0===n.length&&n.push(a.createElement("span",{key:"placeholder-".concat(e.sourcePosition.start.line)},"\xa0")),a.createElement("li",null,a.createElement(L,{checked:e.checked,onChange:function(n){return e.toggleCheckbox(n,t,e)},labels:n}),r)}return Object(A.listItem)(e)}function M(e){return e?"- [x]":"- [ ]"}var U=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).renderParagraph=function(e){return a.createElement(a.Fragment,null,e.children,a.createElement("br",null))},r.state={value:e.value},r}return Object(l.a)(n,[{key:"setValue",value:function(e){this.setState({value:e}),this.props.onChange(e)}},{key:"toggleCheckbox",value:function(e,t,n){var a=this.state.value.split("\n");a[t]=a[t].replace(M(n.checked),M(!n.checked)),this.setValue(a.join("\n"))}},{key:"setDate",value:function(e,t){var n=this.state.value.slice(0,t.start.offset),a=this.state.value.slice(t.end.offset),r=N(e);this.setValue(n+r+a)}},{key:"render",value:function(){var e=this;return a.createElement(E.a,{source:this.state.value,renderers:{listItem:function(t){return a.createElement(K,Object.assign({toggleCheckbox:function(t,n,a){return e.toggleCheckbox(t,n,a)}},t))},link:D,paragraph:this.renderParagraph,date:function(t){return a.createElement(T,Object.assign({setDate:function(t,n){return e.setDate(t,n)}},t))}},rawSourcePos:!0,plugins:[w]})}}]),n}(a.Component);var W=/^([\s>]*)(([-*]|(([0-9]+)\.))\s(\[[ x]\])?)?/,V=n(2),z=n.n(V),J=n(8),B=n(22),F=function(){function e(){Object(u.a)(this,e),this.subscribers=[]}return Object(l.a)(e,[{key:"subscribe",value:function(e){this.subscribers.push(e)}},{key:"emit",value:function(e){var t,n=Object(B.a)(this.subscribers);try{for(n.s();!(t=n.n()).done;){(0,t.value)(e)}}catch(a){n.e(a)}finally{n.f()}}}]),e}(),H=function(){function e(){Object(u.a)(this,e),this.token=localStorage.getItem(e.localStorageKey),this.loggedInEv=new F}return Object(l.a)(e,[{key:"login",value:function(){var t=Object(J.a)(z.a.mark((function t(n,a){var r,i;return z.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(Y,"/api-token-auth/"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:n,password:a})});case 2:return r=t.sent,t.next=5,r.json();case 5:return i=t.sent,this.token=i.token,localStorage.setItem(e.localStorageKey,i.token),this.loggedInEv.emit(),t.abrupt("return",this.token);case 10:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"logout",value:function(){this.token=null}},{key:"register",value:function(){var t=Object(J.a)(z.a.mark((function t(n,a){var r,i;return z.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(Y,"/api-token-auth/"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({username:n,password:a})});case 2:return r=t.sent,t.next=5,r.json();case 5:return i=t.sent,this.token=i.token,localStorage.setItem(e.localStorageKey,i.token),this.loggedInEv.emit(),t.abrupt("return",this.token);case 10:case"end":return t.stop()}}),t,this)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"loggedIn",value:function(){return!!this.token}},{key:"getToken",value:function(){return this.token}}]),e}();H.localStorageKey="token";var G=new H,Y="https://detext.haskai.de/syncify/api",$=function(){function e(t,n){Object(u.a)(this,e),this.name=t,this.validate=n}return Object(l.a)(e,[{key:"fetchEntities",value:function(){var e=Object(J.a)(z.a.mark((function e(){var t,n,a=this;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(Y,"/entity/?tpe=").concat(this.name),{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Token ".concat(G.getToken())}});case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",n.map((function(e){return g(e,a.validate)})));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createEntity",value:function(){var e=Object(J.a)(z.a.mark((function e(t){var n,a;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(Y,"/entity/?tpe=").concat(this.name),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Token ".concat(G.getToken())},body:JSON.stringify(m(t,this.validate))});case 2:return n=e.sent,e.next=5,n.json();case 5:return a=e.sent,e.abrupt("return",g(a,this.validate));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateEntity",value:function(){var e=Object(J.a)(z.a.mark((function e(t){var n,a;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(Y,"/entity/").concat(t.id,"/?tpe=").concat(this.name),{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Token ".concat(G.getToken())},body:JSON.stringify(m(t,this.validate))});case 2:return n=e.sent,e.next=5,n.json();case 5:return a=e.sent,e.abrupt("return",g(a,this.validate));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteEntity",value:function(){var e=Object(J.a)(z.a.mark((function e(t){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(Y,"/entity/").concat(t,"/?tpe=").concat(this.name),{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Token ".concat(G.getToken())}});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),q=n(199);var Q=new(function(){function e(t,n){var a=this;Object(u.a)(this,e),this.entityService=t,this.name=n,G.loggedInEv.subscribe((function(){a.getEntities().then((function(e){}))}))}return Object(l.a)(e,[{key:"storeEntities",value:function(e){localStorage.setItem(this.name,JSON.stringify(e))}},{key:"getEntitiesLocal",value:function(){var e=localStorage.getItem(this.name);null===e&&(e="[]");var t=JSON.parse(e);if(void 0!==this.entityService.validate){var n=this.entityService.validate;return t.map((function(e){return n(e)}))}return t}},{key:"getEntities",value:function(){var e=Object(J.a)(z.a.mark((function e(){var t,n,a,r,i,o,c,s,u,l,h,p,f,d,v,m,g,k,y,b,E;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!G.loggedIn()){e.next=38;break}return e.prev=1,e.next=4,this.entityService.fetchEntities();case 4:t=e.sent,n=this.getEntitiesLocal(),a=this.makeMap(t),r=this.makeMap(n),i=[],o=[],c=[],s=Object(B.a)(n);try{for(s.s();!(u=s.n()).done;)l=u.value,void 0!==a[l.id]?(h=new Date(l.timestamp),p=new Date(a[l.id].timestamp),h>p?c.push(l):i.push(a[l.id])):l.synchronized||o.push(l)}catch(w){s.e(w)}finally{s.f()}f=Object(B.a)(t);try{for(f.s();!(d=f.n()).done;)v=d.value,void 0===r[v.id]&&i.push(v)}catch(w){f.e(w)}finally{f.f()}m=0,g=o;case 16:if(!(m<g.length)){e.next=23;break}return k=g[m],e.next=20,this.entityService.createEntity(k);case 20:m++,e.next=16;break;case 23:y=0,b=c;case 24:if(!(y<b.length)){e.next=31;break}return E=b[y],e.next=28,this.entityService.updateEntity(E);case 28:y++,e.next=24;break;case 31:return t=[].concat(i,o,c),this.storeEntities(t),e.abrupt("return",t);case 36:e.prev=36,e.t0=e.catch(1);case 38:return e.abrupt("return",this.getEntitiesLocal());case 39:case"end":return e.stop()}}),e,this,[[1,36]])})));return function(){return e.apply(this,arguments)}}()},{key:"genId",value:function(){return Object(q.a)()}},{key:"createEntity",value:function(){var e=Object(J.a)(z.a.mark((function e(t){var n,a,r;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Object(c.a)({id:this.genId(),timestamp:(new Date).toISOString()},t),!G.loggedIn()){e.next=13;break}return e.prev=2,e.next=5,this.entityService.createEntity(n);case 5:a=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),a=n;case 11:e.next=14;break;case 13:a=n;case 14:return(r=this.getEntitiesLocal()).push(a),this.storeEntities(r),e.abrupt("return",a.id);case 18:case"end":return e.stop()}}),e,this,[[2,8]])})));return function(t){return e.apply(this,arguments)}}()},{key:"updateEntity",value:function(){var e=Object(J.a)(z.a.mark((function e(t){var n,a;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.timestamp=(new Date).toISOString(),!G.loggedIn()){e.next=9;break}return e.prev=2,e.next=5,this.entityService.updateEntity(t);case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:n=this.getEntitiesLocal(),a=0;case 11:if(!(a<n.length)){e.next=18;break}if(n[a].id!=t.id){e.next=15;break}return n[a]=t,e.abrupt("break",18);case 15:a++,e.next=11;break;case 18:this.storeEntities(n);case 19:case"end":return e.stop()}}),e,this,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getEntity",value:function(e){for(var t=this.getEntitiesLocal(),n=0;n<t.length;n++)if(t[n].id==e)return t[n]}},{key:"deleteEntity",value:function(){var e=Object(J.a)(z.a.mark((function e(t){var n,a;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!G.loggedIn()){e.next=8;break}return e.prev=1,e.next=4,this.entityService.deleteEntity(t);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:n=this.getEntitiesLocal(),a=0;case 10:if(!(a<n.length)){e.next=17;break}if(n[a].id!=t){e.next=14;break}return n.splice(a,1),e.abrupt("break",17);case 14:a++,e.next=10;break;case 17:return this.storeEntities(n),e.abrupt("return",n);case 19:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()},{key:"makeMap",value:function(e){var t,n={},a=Object(B.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;n[r.id]=r}}catch(i){a.e(i)}finally{a.f()}return n}}]),e}())(new $("note",(function(e){return void 0===e.favorite&&(e.favorite=!1),e})),"note"),X=n(18);var Z=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).input=void 0,r.editorRef=void 0,r.commands=[].concat(Object(s.a)(f.commands.getDefaultCommands()),[{commands:[{name:"Test",icon:function(e){return a.createElement(k.a,{icon:y.e})},children:v.map((function(e){return{name:"C1",icon:function(t){return a.createElement("span",{style:{color:e}},a.createElement(k.a,{icon:y.c}))},execute:function(t,n){r.setColor(e)}}}))}]}]),r.state={note:{markdown:"",id:"",name:"Placeholder",color:"white",timestamp:"",synchronized:!1,favorite:!1},tab:"write",editTitle:!1,loaded:!1},r.editorRef=a.createRef(),r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.match.params.noteId,t=Q.getEntity(e),n="write";if(window.location.search){var a=new URLSearchParams(window.location.search).get("tab");"write"!==a&&"preview"!==a||(n=a)}t&&this.setState({note:t,tab:n,loaded:!0})}},{key:"componentDidUpdate",value:function(){var e=document.getElementsByClassName("mde-text");e.length>0&&!this.input&&(this.input=e[0],this.input.addEventListener("keydown",this.handleKeyPress.bind(this)))}},{key:"handleKeyPress",value:function(e){var t=this;"Enter"===e.key?setTimeout((function(){t.handleEnter(e)}),10):"Tab"===e.key&&(e.preventDefault(),setTimeout((function(){t.handleTab(e)}),10))}},{key:"handleTab",value:function(e){var t=e.target.selectionStart,n=this.state.note.markdown,a=function(e,t){for(var n=e.split("\n"),a=0;t>n[a].length;)t-=n[a].length,t-=1,a+=1;if(a<n.length)return n[a]}(n,t);if(a){var r=a.match(W);if(r){var i=function(e,t){for(var n=e.split("\n"),a=0,r=0;t>n[a].length;)t-=n[a].length,t-=1,r+=n[a].length+1,a+=1;return r}(n,t);if(e.shiftKey){if(r[1].length>=4){var o=[n.slice(0,i),n.slice(i+4)].join("");this.setValue(o),setTimeout((function(){e.target.selectionStart=t-4,e.target.selectionEnd=t-4}),0)}}else{var c=[n.slice(0,i),"    ",n.slice(i)].join("");this.setValue(c),setTimeout((function(){e.target.selectionStart=t+4,e.target.selectionEnd=t+4}),0)}}}}},{key:"handleEnter",value:function(e){var t=e.target.selectionStart,n=this.state.note.markdown,a=function(e,t){for(var n=e.split("\n"),a=0;t>n[a].length;)t-=n[a].length,t-=1,a+=1;if(a>0)return n[a-1]}(n,t);if(a){var r=a.match(W);if(r){var i=r[1];void 0!==r[5]?i+="".concat(parseInt(r[5])+1,". "):void 0!==r[3]&&(i+="".concat(r[3]," ")),r[6]&&(i+="".concat(r[6]," "));var o=[n.slice(0,t),i,n.slice(t)].join("");this.setValue(o),setTimeout((function(){e.target.selectionStart=t+i.length,e.target.selectionEnd=t+i.length}),0)}}}},{key:"setValue",value:function(e){this.setState({note:Object(c.a)({},this.state.note,{markdown:e})}),Q.updateEntity(Object(c.a)({},this.state.note,{markdown:e}))}},{key:"setTab",value:function(e){this.setState({tab:e})}},{key:"setColor",value:function(e){this.setState({note:Object(c.a)({},this.state.note,{color:e})}),Q.updateEntity(Object(c.a)({},this.state.note,{color:e}))}},{key:"toggleEdit",value:function(){this.setState({editTitle:!this.state.editTitle})}},{key:"setName",value:function(e){this.setState({note:Object(c.a)({},this.state.note,{name:e})}),Q.updateEntity(Object(c.a)({},this.state.note,{name:e}))}},{key:"editKeyUp",value:function(e){"Enter"===e.nativeEvent.key&&this.toggleEdit()}},{key:"goBack",value:function(e,t){e.stopPropagation(),t.goBack()}},{key:"insertDate",value:function(e){if(Array.isArray(e)&&(e=e[0]),this.editorRef.current){for(var t=this.editorRef.current.textAreaRef,n=t.selectionStart,a=n;a>0&&"@"!==this.state.note.markdown[a];)a--;var r=this.state.note.markdown.slice(0,a),i=this.state.note.markdown.slice(n),o=N(e)+" ";this.setValue(r+o+i),setTimeout((function(){t.selectionStart=r.length+o.length,t.selectionEnd=r.length+o.length,t.dispatchEvent(new KeyboardEvent("keydown",{bubbles:!0,key:"Escape"}))}),10)}}},{key:"loadSuggestions",value:function(e){var t=this;return 0===e.length?Promise.resolve([{preview:a.createElement("div",{onClick:function(e){return e.stopPropagation()}},a.createElement(S.a,{onChange:function(e){return t.insertDate(e)}})),value:"("}]):Promise.resolve([])}},{key:"render",value:function(){var e,t=this;if(!this.state.loaded)return a.createElement(a.Fragment,null);e=this.state.editTitle?function(e){return a.createElement("div",{className:"note-title"},a.createElement("input",{value:t.state.note.name,onChange:function(e){return t.setName(e.target.value)},onKeyUp:function(e){return t.editKeyUp(e)},autoFocus:!0,className:"editName"}),a.createElement("span",{className:"edit"},a.createElement(k.a,{icon:y.f})))}:function(e){return a.createElement("div",{className:"note-title",onClick:function(){return t.toggleEdit()}},a.createElement("button",{className:"pure-button",onClick:function(n){return t.goBack(n,e)}},a.createElement(k.a,{icon:y.a})),a.createElement("div",{className:"edit-region"},t.state.note.name,a.createElement("span",{className:"edit"},a.createElement(k.a,{icon:y.f}))))};var n=this.state.note.markdown.split("\n").length,r=window.innerHeight-200,i=Math.min(r,Math.max(300,22*n));return a.createElement(X.a,{render:function(n){var o=n.history;return a.createElement("div",null,e(o),a.createElement(d.a,{value:t.state.note.markdown,onChange:function(e){return t.setValue(e)},selectedTab:t.state.tab,onTabChange:function(e){return t.setTab(e)},generateMarkdownPreview:function(e){return Promise.resolve(a.createElement(U,{value:e,onChange:function(e){return t.setValue(e)}}))},commands:t.commands,classes:{textArea:t.state.note.color,preview:t.state.note.color},suggestionTriggerCharacters:["@"],loadSuggestions:function(e){return t.loadSuggestions(e)},ref:t.editorRef,minEditorHeight:i,maxEditorHeight:r}))}})}}]),n}(a.Component),_=(n(190),n(191),n(192),n(193),n(23)),ee=(n(194),n(69)),te=function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"edit",value:function(e){e.preventDefault(),e.stopPropagation(),this.props.editClicked(this.props.id)}},{key:"delete",value:function(e){e.preventDefault(),e.stopPropagation(),this.props.deleteClicked(this.props.id)}},{key:"favorite",value:function(e){e.preventDefault(),e.stopPropagation(),this.props.favoriteClicked(this.props.id)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"preview ".concat(this.props.color)},r.a.createElement("div",{className:"title"},this.props.name,r.a.createElement("span",{className:"favorite",onClick:function(t){return e.favorite(t)}},r.a.createElement(k.a,{icon:this.props.favorite?y.i:ee.a})),r.a.createElement("span",{className:"delete",onClick:function(t){return e.delete(t)}},r.a.createElement(k.a,{icon:y.j})),r.a.createElement("span",{className:"edit-preview",onClick:function(t){return e.edit(t)}},r.a.createElement(k.a,{icon:y.d}))),r.a.createElement(U,{value:this.props.markdown,onChange:function(){}}))}}]),n}(r.a.Component),ne=(n(195),function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e,a){var r;return Object(u.a)(this,n),(r=t.call(this,e,a)).state={notes:[],choosing:!1,loggedIn:!1},r}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.setState({notes:Q.getEntitiesLocal(),loggedIn:G.loggedIn()}),Q.getEntities().then((function(t){e.setState({notes:t})}))}},{key:"newNote",value:function(){var e=Object(J.a)(z.a.mark((function e(t){var n,a,r,i=arguments;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]?i[1]:"empty",a={name:"New Note",markdown:"empty"===n?"":"- [ ] ",color:"white",favorite:!1},e.next=4,Q.createEntity(a);case 4:r=e.sent,t.push("/note/".concat(r,"?tab=write"));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"toNote",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"preview";t.push("/note/".concat(e,"?tab=").concat(n))}},{key:"deleteNote",value:function(){var e=Object(J.a)(z.a.mark((function e(t){var n;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Q.deleteEntity(t);case 2:n=e.sent,this.setState({notes:n});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"favoriteNote",value:function(){var e=Object(J.a)(z.a.mark((function e(t){var n;return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=Q.getEntity(t))){e.next=6;break}return n.favorite=!n.favorite,e.next=5,Q.updateEntity(n);case 5:this.setState({notes:Q.getEntitiesLocal()});case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"login",value:function(e){e.push("/login/")}},{key:"logout",value:function(){G.logout(),this.setState({loggedIn:G.loggedIn()})}},{key:"render",value:function(){var e=this,t=this.state.notes.sort((function(e,t){return e.favorite?-1:t.favorite?1:new Date(e.timestamp)>new Date(t.timestamp)?-1:1}));return a.createElement(X.a,{render:function(n){var r=n.history;return a.createElement("div",{className:"home"},a.createElement("table",{className:"home"},a.createElement("tbody",null,a.createElement("tr",{className:"actions"},a.createElement("td",{className:"actions"},a.createElement("button",{className:"pure-button mr-2",onClick:function(){return e.newNote(r)}},a.createElement(k.a,{icon:y.g})),a.createElement("button",{className:"pure-button",onClick:function(){return e.newNote(r,"checklist")}},a.createElement(k.a,{icon:y.b})),e.state.loggedIn?a.createElement("button",{className:"pure-button logout",onClick:function(){return e.logout()}},a.createElement(k.a,{icon:y.h})):a.createElement("button",{className:"pure-button login",onClick:function(){return e.login(r)}},a.createElement(k.a,{icon:y.k})))),t.map((function(t){return a.createElement("tr",{className:"note",key:t.id},a.createElement("td",{className:"note",onClick:function(){return e.toNote(t.id,r)}},a.createElement(te,Object.assign({},t,{deleteClicked:function(t){return e.deleteNote(t)},editClicked:function(t){return e.toNote(t,r,"write")},favoriteClicked:function(t){return e.favoriteNote(t)}}))))})))))}})}}]),n}(a.Component)),ae=(n(196),function(e){Object(h.a)(n,e);var t=Object(p.a)(n);function n(e,a){var r;return Object(u.a)(this,n),(r=t.call(this,e,a)).state={register:!1},r}return Object(l.a)(n,[{key:"login",value:function(e,t){var n=this;t.preventDefault(),t.stopPropagation();var a=t.target[1].value,r=t.target[2].value;this.state.register?r===t.target[3].value?G.register(a,r).then((function(t){void 0!==t?e.push("/"):n.setState({error:"Could not log in"})})):this.setState({error:"Passwords do not match"}):G.login(a,r).then((function(t){void 0!==t?e.push("/"):n.setState({error:"Could not log in"})}))}},{key:"toggleRegister",value:function(){this.setState({register:!this.state.register})}},{key:"render",value:function(){var e=this;return a.createElement(X.a,{render:function(t){var n=t.history;return a.createElement("div",{className:"login"},a.createElement("button",{className:"pure-button",onClick:function(){return n.goBack()}},a.createElement(k.a,{icon:y.a})),a.createElement("form",{className:"pure-form",onSubmit:function(t){return e.login(n,t)}},a.createElement("fieldset",null,a.createElement("legend",null,"Login"),a.createElement("input",{type:"username",placeholder:"Username"}),a.createElement("input",{type:"password",placeholder:"Password"}),e.state.register?a.createElement("input",{type:"password",placeholder:"Repeat Password"}):a.createElement("span",null),a.createElement("button",{type:"submit",className:"pure-button pure-button-primary"},e.state.register?"Register":"Sign in"),e.state.error?e.state.error:"")))}})}}]),n}(a.Component));var re=function(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"pure-g center"},r.a.createElement("div",{className:"pure-u-1 pure-u-md-1-5"}),r.a.createElement("div",{className:"pure-u-1 pure-u-md-3-5"},r.a.createElement(_.a,{basename:"/note-pwa"},r.a.createElement(X.c,null,r.a.createElement(X.a,{path:"/note/:noteId",component:Z}),r.a.createElement(X.a,{path:"/login/"},r.a.createElement(ae,null)),r.a.createElement(X.a,{path:"/"},r.a.createElement(ne,null)))))))},ie=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function oe(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(re,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/note-pwa",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/note-pwa","/service-worker.js");ie?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):oe(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):oe(t,e)}))}}()},71:function(e,t,n){e.exports=n(197)},76:function(e,t,n){}},[[71,1,2]]]);
//# sourceMappingURL=main.d5197d9a.chunk.js.map